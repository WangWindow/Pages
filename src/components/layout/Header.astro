---
import logoSrc from "@assets/icon.ico";
import { MobilePostHeader } from "@components/layout/MobilePostHeader";
import { MenuIcon } from "@components/ui/MenuIcon";
import { MAX_WIDTH } from "@constants/layout";
import { siteConfig } from "constants/site-config";
import Navigator from "./Navigator";

interface Props {
  isPostPage?: boolean;
  tocNumbering?: boolean;
}

const { isPostPage = false, tocNumbering = true } = Astro.props;
const { alternate, title, showLogo } = siteConfig;
---

<div
  id="site-header"
  class={`shadow-text fixed tablet:backdrop-blur inset-x-0 top-0 z-30 gap-4 py-2.5 text-white select-none tablet:py-2 tablet:pl-3 tablet:pr-0 overflow-visible`}
  transition:name="site-header"
>
  <div
    class={`mx-auto flex items-center justify-between tablet:w-full px-6 tablet:pl-10 tablet:pr-3 ${MAX_WIDTH.content}`}
  >
    <!-- Desktop: Always show logo -->
    <a
      transition:persist="page-header-avatar"
      class="tablet:hidden -my-4 mr-4 flex cursor-pointer items-center justify-center gap-1 whitespace-nowrap"
      href="/"
      target="_self"
      title={alternate || title}
      aria-label={alternate || title}
    >
      {
        showLogo ? (
          <img src={logoSrc} alt={alternate || title} class="h-8 w-8" />
        ) : (
          <p class="logo-text">{alternate || title}</p>
        )
      }
    </a>
    <!-- Mobile: MobilePostHeader (shows heading on post pages, logo otherwise) -->
    <div class="tablet:flex tablet:grow hidden items-center justify-center">
      <MobilePostHeader
        client:only="react"
        isPostPage={isPostPage}
        enableNumbering={tocNumbering}
        logoElement="svg"
        logoText={alternate || title}
        logoSrc={logoSrc}
      />
    </div>
    <Navigator client:load currentPath={Astro.url.pathname} />
  </div>
</div>

<!-- 移动端菜单按钮 -->
<MenuIcon
  client:only="react"
  className="tablet:flex fixed top-0 left-3 z-52 hidden h-14 transition-transform"
  id="mobile-menu-container"
/>
